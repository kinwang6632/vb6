--o布CUSTSNAME<>SO002A.CHARGETITLE or custsname<>so002.contname
SELECT 'o布CUSTSNAME<>bめΜンH(Τb腹)' p,A.CUSTID "冉s",A.CUSTNAME "泉A-mW",
B.CHARGETITLE "泉A--bめΜンH",c.bankname "蝗妲O",c.accountno "b腹",
B.INVTITLE "泉A--o布╋Y",B.INVNO "泉A--参s",C.BILLNO "ΜO虫腹",D.INVID "o布腹",
D.CUSTSNAME "o布-趣岍mW",D.INVTITLE "w}o布╋Y",D.BUSINESSID "o布-参s",c.realdate,d.invdate
FROM SO001 A,SO002A B,SO034 C,INV007 D
WHERE A.CUSTID=B.CUSTID AND A.CUSTID=C.CUSTID AND C.GUINO=D.INVID
  AND C.SERVICETYPE IN ('I','D')  AND C.ACCOUNTNO IS NOT NULL
  AND B.BANKCODE=C.BANKCODE  AND B.ACCOUNTNO=C.ACCOUNTNO
  AND REALDATE>=TO_DATE('20040420','YYYYMMDD') AND B.CHARGETITLE<>D.CUSTSNAME   
unioN all 
SELECT 'o布CUSTSNAME<>A叭p蹈H(Lb腹)' p,A.CUSTID "冉s",A.CUSTNAME "泉A-mW",
B.CONTNAME "泉A--bめΜンH",c.bankname "蝗妲O",c.accountno "b腹",
B.INVTITLE "泉A--o布╋Y",B.INVNO "泉A--参s",C.BILLNO "ΜO虫腹",D.INVID "o布腹",
D.CUSTSNAME"o布-趣岍mW",D.INVTITLE "w}o布╋Y",D.BUSINESSID "o布-参s",c.realdate,d.invdate
FROM SO001 A,SO002 B,SO034 C,INV007 D
WHERE A.CUSTID=B.CUSTID AND A.CUSTID=C.CUSTID AND C.GUINO=D.INVID
  AND C.SERVICETYPE IN ('I','D') AND B.SERVICETYPE=C.SERVICETYPE 
  AND C.ACCOUNTNO IS  NULL
  AND REALDATE>=TO_DATE('20040420','YYYYMMDD') AND A.CUSTNAME<>D.CUSTSNAME





--LSC ....莱挨Tp}欷Gp
SELECT 'LSC--莱挨Tp}挨Gp(Τb腹)' "p",CUSTID "泉A冉s",TITLECUST,
INVID "o布腹X",BILLNO "ΜO虫腹",Realdate,
INVCUSTID "o布冉s",CUSTSNAME "o布mW",TITLEINV,
INVNO "泉A参s",BUSINESSID "o布参s" FROM 
(select a.custid,A.CHARGETITLE chargetitle,
A.INVTITLE TITLECUST,b.realdate,
C.CUSTSNAME,C.INVTITLE TITLEINV,
a.accountno,a.invno,C.BUSINESSID,a.invoicetype,
B.BILLNO,B.GUINO,B.INVDATE,B.REALAMT,C.INVID,C.CUSTID INVCUSTID,C.INVAMOUNT
 from so002a a,so034 b, INV007 C 
 where  b.servicetype in ('I','D')  AND A.CUSTID=B.CUSTID 
 AND B.accountno IS NOT NULL  AND B.BANKCODE=A.BANKCODE AND A.ACCOUNTNO=B.ACCOUNTNO
 AND C.INVID=B.GUINO AND C.BUSINESSID IS NULL AND A.INVNO IS NOT NULL
 AND B.REALDATE>=TO_DATE('20040420','YYYYMMDD'))
UNION ALL
SELECT 'LSC--莱挨Tp}挨Gp(Lb腹)' "p",CUSTID "泉A冉s",TITLECUST,
INVID "o布腹X",BILLNO "ΜO虫腹",Realdate,
INVCUSTID "o布冉s",CUSTSNAME "o布mW",TITLEINV,
INVNO "泉A参s",BUSINESSID "o布参s" FROM 
(select a.custid,A.CONTNAME chargetitle,A.INVTITLE TITLECUST,
C.CUSTSNAME,C.INVTITLE TITLEINV,b.realdate,
a.accountno,a.invno,C.BUSINESSID,a.invoicetype,
B.BILLNO,B.GUINO,B.INVDATE,B.REALAMT,C.INVID,C.CUSTID INVCUSTID,C.INVAMOUNT
 from so002 a,so034 b, INV007 C,so001 d
 where  b.servicetype in ('I','D') and a.servicetype=b.servicetype and a.custid=d.custid 
 AND A.CUSTID=B.CUSTID 
 AND B.accountno IS NULL
 AND C.INVID=B.GUINO AND C.BUSINESSID IS NULL AND A.INVNO IS NOT NULL
 AND B.REALDATE>=TO_DATE('20040420','YYYYMMDD'))


 



/* h荧趣岫}ミbP@o布W */

SELECT 'h荧趣岫}ミbP@o布W' p,
A.CUSTID 泉A冉s,A.GUINO o布腹X,A.BILLNO ΜO虫腹,A.ITEM 兜Ω,
A.CITEMCODE ΜONX,A.CITEMNAME ΜO兜ヘ,B.CUSTID o布冉s,
A.REALDATE,A.MEDIABILLNO,A.ACCOUNTNO,A.invoicetime ,C.INVTITLE "002TITLE",B.INVTITLE  "007TITLE"
FROM SO034 A,INV007 B, so002 c
WHERE A.REALDATE>=TO_DATE('20040420','YYYYMMDD') AND A.GUINO IN (
SELECT GUINO FROM (
SELECT GUINO,CUSTID,BILLNO FROM SO034 
WHERE REALDATE>=TO_DATE('20040420','YYYYMMDD')
GROUP BY GUINO,CUSTID,BILLNO 
) QQ GROUP BY GUINO HAVING COUNT(*) > 1) AND A.GUINO=B.INVID 
AND A.CUSTID<>to_number(B.custid) 
and a.custid=c.custid and a.servicetype='C' AND C.SERVICETYPE='C'
ORDER BY A.GUINO

  





/* o布╋YぃP┪参sΤ~ */ 
SELECT 'Lbめ--o布╋YぃP' p,A.CUSTID,B.CUSTNAME,C.BILLNO,C.GUINO,C.REALDATE,
A.INVTITLE,D.INVTITLE INVNAME,A.INVNO,D.BUSINESSID
FROM SO002 A,SO001 B,SO034 C,INV007 D
WHERE A.CUSTID=B.CUSTID AND A.CUSTID=C.CUSTID
  AND A.SERVICETYPE=C.SERVICETYPE AND A.SERVICETYPE IN ('I','D')
  AND C.GUINO=D.INVID AND C.ACCOUNTNO IS NULL 
  AND C.REALDATE>=TO_DATE('20040420','YYYYMMDD')
  AND A.INVOICETYPE=3 AND A.INVTITLE<>D.INVTITLE
UNION ALL
SELECT 'Lbめ--参sΤ~' p,A.CUSTID,B.CUSTNAME,C.BILLNO,C.GUINO,C.REALDATE,
A.INVTITLE,D.INVTITLE INVNAME,A.INVNO,D.BUSINESSID
FROM SO002 A,SO001 B,SO034 C,INV007 D
WHERE A.CUSTID=B.CUSTID AND A.CUSTID=C.CUSTID
  AND A.SERVICETYPE=C.SERVICETYPE AND A.SERVICETYPE IN ('I','D')
  AND C.GUINO=D.INVID AND C.ACCOUNTNO IS NULL 
  AND C.REALDATE>=TO_DATE('20040420','YYYYMMDD')
  AND A.INVOICETYPE=3 AND A.INVNO<>D.BUSINESSID 
UNION ALL 
SELECT 'Τbめ--o布╋YぃP' p,A.CUSTID,B.CUSTNAME,C.BILLNO,C.GUINO,C.REALDATE,
A.INVTITLE,D.INVTITLE INVNAME,A.INVNO,D.BUSINESSID
FROM SO002A A,SO001 B,SO034 C,INV007 D
WHERE A.CUSTID=B.CUSTID AND A.CUSTID=C.CUSTID  
  AND C.SERVICETYPE IN ('I','D') AND A.BANKCODE IS NOT NULL 
  AND A.BANKCODE=C.BANKCODE AND A.ACCOUNTNO=C.ACCOUNTNO 
  AND C.GUINO=D.INVID 
  AND C.REALDATE>=TO_DATE('20040420','YYYYMMDD')
  AND A.INVOICETYPE=3 AND A.INVTITLE<>D.INVTITLE
UNION ALL
SELECT 'Τbめ--参sΤ~' p,A.CUSTID,B.CUSTNAME,C.BILLNO,C.GUINO,C.REALDATE,
A.INVTITLE,D.INVTITLE INVNAME,A.INVNO,D.BUSINESSID
FROM SO002A A,SO001 B,SO034 C,INV007 D
WHERE A.CUSTID=B.CUSTID AND A.CUSTID=C.CUSTID  
  AND C.SERVICETYPE IN ('I','D') AND A.BANKCODE IS NOT NULL 
  AND A.BANKCODE=C.BANKCODE AND A.ACCOUNTNO=C.ACCOUNTNO 
  AND C.GUINO=D.INVID 
  AND C.REALDATE>=TO_DATE('20040420','YYYYMMDD')
  AND A.INVOICETYPE=3 AND  A.INVNO<>D.BUSINESSID

